# Web Application Firewall (WAF)

WAF helps protect web applications by filtering incoming HTTP traffic. It's a layer-7 protection mechanism that works by recognizing malicious patterns in payloads for known attacks

- [ModSecurity](https://github.com/owasp-modsecurity/ModSecurity) is an open-source WAF that started out as a pluggable module to popular webservers (apache, nginx, and IIS).
- ModSecurity is commonly used with the [Core Ruleset](https://github.com/coreruleset/coreruleset) (CRS): a set of generic detection rules fom common attack categories (e.g., XSS, file inclusion, SQL injection, etc.).

## Practice

- Deploy Modsecurity in front of the vulnerable app using docker compose

    ```yaml
    services:
        app:
            container_name: app
            image: sh3b0/tiwap:latest
        waf:
            container_name: waf
            image: owasp/modsecurity-crs:nginx
            environment:
                - BACKEND=http://app:5000
            ports:
                - "127.0.0.1:5000:8080"
    ```

- Test a previously-working exploit again (e.g., Command injection or XSS).

## Task 4

1. Send a malicious payload that bypasses WAF (to any endpoint).

1. Update Modsecurity's [config](https://github.com/coreruleset/modsecurity-crs-docker/blob/main/src/etc/modsecurity.d/modsecurity.conf) by adding additional rule to block your exploit.

1. Re-deploy the WAF and verify that your config works.
